# Generated by `rjournal_pdf_article()` using `knitr::purl()`: do not edit by hand
# Please edit langevitour-article.Rmd to modify this file

## ----setup, include=FALSE-----------------------------------------------------
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(png)
library(cowplot)
library(grid)
source("util.R")
source("figures.R")


## ----echo=TRUE,eval=FALSE-----------------------------------------------------
#> library(langevitour)
#> library(palmerpenguins)
#> 
#> completePenguins <- na.omit(penguins[,c(1,3,4,5,6)])
#> scale <- apply(completePenguins[,-1], 2, sd)*4
#> 
#> langevitour(completePenguins[,-1], completePenguins$species,
#>             scale=scale, pointSize=2)


## ----penguins, fig.cap=caption("\\CRANpkg{palmerpenguins} data visualized using \\CRANpkg{langevitour}. Each dot is a penguin, and the axes are four different penguin measurements."," (A) The widget initially spins at random. (B) The user has selected the PCA guide, and the widget has rotated to an informative projection using this guide. (C) The user has moused over a label, causing points to be colored by that variable. (D) The user has dragged a label onto the plot to concentrate on a particular variable.", " Interact with this figure directly or use the buttons in the text, which will adjust the figure to demonstrate various features.")----
if (isHTML) {
    figurePenguins
} else {
    plot_grid(
        rasterGrob(readPNG("figures/figure1A.png")),
        rasterGrob(readPNG("figures/figure1B.png")),
        rasterGrob(readPNG("figures/figure1C.png")),
        rasterGrob(readPNG("figures/figure1D.png")),
        scale=0.9, ncol=2, labels="AUTO", label_fontface="plain", label_size=10)
}


## ----standard, fig.height=3.5, fig.cap="scRNA-Seq analysis using Seurat. (A) A scree plot showing variance accounted for by each PC. The scree plot has a fat tail, indicating that variation in the data can not be summarized with only a few PCs. (B) UMAP layout based on the cell scores of the first 10 PCs. U are unstimulated and S are stimulated cells.", fig.alt="(A) A plot with PCA component on the x axis and variance of the component on the y axis. The plot descends quickly in the first three components then descends more slowly. (B) A UMAP plot of cells colored by cell type and stimulation. Stimulated and unstimulated clusters for different cell types seem to mirror each other, but the plot as a whole is not completely symmetric."----
figureStandard


## ----raw, layout="l-body-outset", fig.cap=caption("scRNA-Seq cell scores visualized using langevitour."," The \"local\" guide is active. (A) Unstimulated cells. (B) All cells. (C) Colored by component 3. (D) Doublets hidden.")----
if (isHTML) {
    figureRaw
} else {
    plot_grid(
        rasterGrob(readPNG("figures/figure3A.png")),
        rasterGrob(readPNG("figures/figure3B.png")),
        rasterGrob(readPNG("figures/figure3C.png")),
        rasterGrob(readPNG("figures/figure3D.png")),
        scale=0.9, ncol=2, labels="AUTO", label_fontface="plain", label_size=10)
}


## ----denoising, fig.height=4, fig.cap=caption("Noise reduction of scRNA-Seq cell scores. Original and denoised positions of 1,000 cells are shown, joined by lines.","")----
if (isHTML) {
    figureDenoising
} else {
    plot_grid(rasterGrob(readPNG("figures/figure4.png")))
}


## ----denoised, layout="l-body-outset", fig.height=4, fig.cap="Noise reduced scRNA-Seq cell scores."----
if (isHTML) {
    figureDenoised
} else {
    plot_grid(rasterGrob(readPNG("figures/figure5.png")))
}


## ----gene, fig.height=3, fig.cap=caption("scRNA-Seq gene loadings visualized using langevitour. The points are genes and the variables are the loading for each component."," (A) Genes involved in component 3. (B) Genes involved in components 1 and 2.")----
if (isHTML) {
    figureGene
} else {
    plot_grid(
        rasterGrob(readPNG("figures/figure6A.png")),
        rasterGrob(readPNG("figures/figure6B.png")),
        scale=0.9, ncol=2, labels="AUTO", label_fontface="plain", label_size=10)
}

